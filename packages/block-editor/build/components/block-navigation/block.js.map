{"version":3,"sources":["@wordpress/block-editor/src/components/block-navigation/block.js"],"names":["BlockNavigationBlock","block","isSelected","onClick","position","level","rowCount","showBlockMovers","terminatedLevels","path","cellRef","isHovered","setIsHovered","isFocused","setIsFocused","selectEditorBlock","selectBlock","clientId","siblingCount","hasSiblings","hasRenderedMovers","hasVisibleMovers","moverCellClassName","withExperimentalFeatures","__experimentalFeatures","blockNavigationBlockSettingsClassName","current","focus","undefined","ref","tabIndex","onFocus","moreVertical","onClose"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport classnames from 'classnames';\n\n/**\n * WordPress dependencies\n */\nimport {\n\t__experimentalTreeGridCell as TreeGridCell,\n\t__experimentalTreeGridItem as TreeGridItem,\n\tMenuGroup,\n\tMenuItem,\n} from '@wordpress/components';\nimport { __ } from '@wordpress/i18n';\nimport { moreVertical } from '@wordpress/icons';\nimport { useState, useRef, useEffect } from '@wordpress/element';\nimport { useDispatch } from '@wordpress/data';\n\n/**\n * Internal dependencies\n */\nimport BlockNavigationLeaf from './leaf';\nimport {\n\tBlockMoverUpButton,\n\tBlockMoverDownButton,\n} from '../block-mover/button';\nimport DescenderLines from './descender-lines';\nimport BlockNavigationBlockContents from './block-contents';\nimport BlockSettingsDropdown from '../block-settings-menu/block-settings-dropdown';\nimport { useBlockNavigationContext } from './context';\n\nexport default function BlockNavigationBlock( {\n\tblock,\n\tisSelected,\n\tonClick,\n\tposition,\n\tlevel,\n\trowCount,\n\tshowBlockMovers,\n\tterminatedLevels,\n\tpath,\n} ) {\n\tconst cellRef = useRef( null );\n\tconst [ isHovered, setIsHovered ] = useState( false );\n\tconst [ isFocused, setIsFocused ] = useState( false );\n\tconst { selectBlock: selectEditorBlock } = useDispatch(\n\t\t'core/block-editor'\n\t);\n\tconst { clientId } = block;\n\n\t// Subtract 1 from rowCount, as it includes the block appender.\n\tconst siblingCount = rowCount - 1;\n\tconst hasSiblings = siblingCount > 0;\n\tconst hasRenderedMovers = showBlockMovers && hasSiblings;\n\tconst hasVisibleMovers = isHovered || isFocused;\n\tconst moverCellClassName = classnames(\n\t\t'block-editor-block-navigation-block__mover-cell',\n\t\t{ 'is-visible': hasVisibleMovers }\n\t);\n\tconst {\n\t\t__experimentalFeatures: withExperimentalFeatures,\n\t} = useBlockNavigationContext();\n\tconst blockNavigationBlockSettingsClassName = classnames(\n\t\t'block-editor-block-navigation-block__menu-cell',\n\t\t{ 'is-visible': hasVisibleMovers }\n\t);\n\tuseEffect( () => {\n\t\tif ( withExperimentalFeatures && isSelected ) {\n\t\t\tcellRef.current.focus();\n\t\t}\n\t}, [ withExperimentalFeatures, isSelected ] );\n\n\treturn (\n\t\t<BlockNavigationLeaf\n\t\t\tclassName={ classnames( {\n\t\t\t\t'is-selected': isSelected,\n\t\t\t} ) }\n\t\t\tonMouseEnter={ () => setIsHovered( true ) }\n\t\t\tonMouseLeave={ () => setIsHovered( false ) }\n\t\t\tonFocus={ () => setIsFocused( true ) }\n\t\t\tonBlur={ () => setIsFocused( false ) }\n\t\t\tlevel={ level }\n\t\t\tposition={ position }\n\t\t\trowCount={ rowCount }\n\t\t\tpath={ path }\n\t\t>\n\t\t\t<TreeGridCell\n\t\t\t\tclassName=\"block-editor-block-navigation-block__contents-cell\"\n\t\t\t\tcolSpan={ hasRenderedMovers ? undefined : 2 }\n\t\t\t\tref={ cellRef }\n\t\t\t>\n\t\t\t\t{ ( { ref, tabIndex, onFocus } ) => (\n\t\t\t\t\t<div className=\"block-editor-block-navigation-block__contents-container\">\n\t\t\t\t\t\t<DescenderLines\n\t\t\t\t\t\t\tlevel={ level }\n\t\t\t\t\t\t\tisLastRow={ position === rowCount }\n\t\t\t\t\t\t\tterminatedLevels={ terminatedLevels }\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<BlockNavigationBlockContents\n\t\t\t\t\t\t\tblock={ block }\n\t\t\t\t\t\t\tonClick={ () => onClick( block.clientId ) }\n\t\t\t\t\t\t\tisSelected={ isSelected }\n\t\t\t\t\t\t\tposition={ position }\n\t\t\t\t\t\t\tsiblingCount={ siblingCount }\n\t\t\t\t\t\t\tlevel={ level }\n\t\t\t\t\t\t\tref={ ref }\n\t\t\t\t\t\t\ttabIndex={ tabIndex }\n\t\t\t\t\t\t\tonFocus={ onFocus }\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t) }\n\t\t\t</TreeGridCell>\n\t\t\t{ hasRenderedMovers && (\n\t\t\t\t<>\n\t\t\t\t\t<TreeGridCell\n\t\t\t\t\t\tclassName={ moverCellClassName }\n\t\t\t\t\t\twithoutGridItem\n\t\t\t\t\t>\n\t\t\t\t\t\t<TreeGridItem>\n\t\t\t\t\t\t\t{ ( { ref, tabIndex, onFocus } ) => (\n\t\t\t\t\t\t\t\t<BlockMoverUpButton\n\t\t\t\t\t\t\t\t\torientation=\"vertical\"\n\t\t\t\t\t\t\t\t\tclientIds={ [ clientId ] }\n\t\t\t\t\t\t\t\t\tref={ ref }\n\t\t\t\t\t\t\t\t\ttabIndex={ tabIndex }\n\t\t\t\t\t\t\t\t\tonFocus={ onFocus }\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t</TreeGridItem>\n\t\t\t\t\t\t<TreeGridItem>\n\t\t\t\t\t\t\t{ ( { ref, tabIndex, onFocus } ) => (\n\t\t\t\t\t\t\t\t<BlockMoverDownButton\n\t\t\t\t\t\t\t\t\torientation=\"vertical\"\n\t\t\t\t\t\t\t\t\tclientIds={ [ clientId ] }\n\t\t\t\t\t\t\t\t\tref={ ref }\n\t\t\t\t\t\t\t\t\ttabIndex={ tabIndex }\n\t\t\t\t\t\t\t\t\tonFocus={ onFocus }\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t</TreeGridItem>\n\t\t\t\t\t</TreeGridCell>\n\t\t\t\t</>\n\t\t\t) }\n\n\t\t\t{ withExperimentalFeatures && (\n\t\t\t\t<TreeGridCell\n\t\t\t\t\tclassName={ blockNavigationBlockSettingsClassName }\n\t\t\t\t>\n\t\t\t\t\t{ ( { ref, tabIndex, onFocus } ) => (\n\t\t\t\t\t\t<BlockSettingsDropdown\n\t\t\t\t\t\t\tclientIds={ [ clientId ] }\n\t\t\t\t\t\t\ticon={ moreVertical }\n\t\t\t\t\t\t\ttoggleProps={ {\n\t\t\t\t\t\t\t\tref,\n\t\t\t\t\t\t\t\ttabIndex,\n\t\t\t\t\t\t\t\tonFocus,\n\t\t\t\t\t\t\t} }\n\t\t\t\t\t\t\tdisableOpenOnArrowDown\n\t\t\t\t\t\t\t__experimentalSelectBlock={ onClick }\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{ ( { onClose } ) => (\n\t\t\t\t\t\t\t\t<MenuGroup>\n\t\t\t\t\t\t\t\t\t<MenuItem\n\t\t\t\t\t\t\t\t\t\tonClick={ async () => {\n\t\t\t\t\t\t\t\t\t\t\t// If clientId is already selected, it won't be focused (see block-wrapper.js)\n\t\t\t\t\t\t\t\t\t\t\t// This removes the selection first to ensure the focus will always switch.\n\t\t\t\t\t\t\t\t\t\t\tawait selectEditorBlock( null );\n\t\t\t\t\t\t\t\t\t\t\tawait selectEditorBlock( clientId );\n\t\t\t\t\t\t\t\t\t\t\tonClose();\n\t\t\t\t\t\t\t\t\t\t} }\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t{ __( 'Go to block' ) }\n\t\t\t\t\t\t\t\t\t</MenuItem>\n\t\t\t\t\t\t\t\t</MenuGroup>\n\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t</BlockSettingsDropdown>\n\t\t\t\t\t) }\n\t\t\t\t</TreeGridCell>\n\t\t\t) }\n\t\t</BlockNavigationLeaf>\n\t);\n}\n"]}