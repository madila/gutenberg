{"version":3,"sources":["@wordpress/block-directory/src/components/auto-block-uninstaller/index.js"],"names":["AutoBlockUninstaller","uninstallBlockType","shouldRemoveBlockTypes","select","isAutosavingPost","isSavingPost","unusedBlockTypes","getUnusedBlockTypes","length","forEach","blockType","name"],"mappings":";;;;;;;AAGA;;AACA;;AACA;;AALA;;;AAOe,SAASA,oBAAT,GAAgC;AAAA,qBACf,uBAAa,sBAAb,CADe;AAAA,MACtCC,kBADsC,gBACtCA,kBADsC;;AAG9C,MAAMC,sBAAsB,GAAG,qBAAW,UAAEC,MAAF,EAAc;AAAA,kBACZA,MAAM,CAAE,aAAF,CADM;AAAA,QAC/CC,gBAD+C,WAC/CA,gBAD+C;AAAA,QAC7BC,YAD6B,WAC7BA,YAD6B;;AAEvD,WAAOA,YAAY,MAAM,CAAED,gBAAgB,EAA3C;AACA,GAH8B,EAG5B,EAH4B,CAA/B;AAKA,MAAME,gBAAgB,GAAG,qBACxB,UAAEH,MAAF;AAAA,WAAcA,MAAM,CAAE,sBAAF,CAAN,CAAiCI,mBAAjC,EAAd;AAAA,GADwB,EAExB,EAFwB,CAAzB;AAKA,0BAAW,YAAM;AAChB,QAAKL,sBAAsB,IAAII,gBAAgB,CAACE,MAAhD,EAAyD;AACxDF,MAAAA,gBAAgB,CAACG,OAAjB,CAA0B,UAAEC,SAAF,EAAiB;AAC1CT,QAAAA,kBAAkB,CAAES,SAAF,CAAlB;AACA,yCAAqBA,SAAS,CAACC,IAA/B;AACA,OAHD;AAIA;AACD,GAPD,EAOG,CAAET,sBAAF,CAPH;AASA,SAAO,IAAP;AACA","sourcesContent":["/**\n * WordPress dependencies\n */\nimport { unregisterBlockType } from '@wordpress/blocks';\nimport { useDispatch, useSelect } from '@wordpress/data';\nimport { useEffect } from '@wordpress/element';\n\nexport default function AutoBlockUninstaller() {\n\tconst { uninstallBlockType } = useDispatch( 'core/block-directory' );\n\n\tconst shouldRemoveBlockTypes = useSelect( ( select ) => {\n\t\tconst { isAutosavingPost, isSavingPost } = select( 'core/editor' );\n\t\treturn isSavingPost() && ! isAutosavingPost();\n\t}, [] );\n\n\tconst unusedBlockTypes = useSelect(\n\t\t( select ) => select( 'core/block-directory' ).getUnusedBlockTypes(),\n\t\t[]\n\t);\n\n\tuseEffect( () => {\n\t\tif ( shouldRemoveBlockTypes && unusedBlockTypes.length ) {\n\t\t\tunusedBlockTypes.forEach( ( blockType ) => {\n\t\t\t\tuninstallBlockType( blockType );\n\t\t\t\tunregisterBlockType( blockType.name );\n\t\t\t} );\n\t\t}\n\t}, [ shouldRemoveBlockTypes ] );\n\n\treturn null;\n}\n"]}