{"version":3,"sources":["@wordpress/e2e-test-utils/src/inserter.js"],"names":["INSERTER_SEARCH_SELECTOR","openGlobalBlockInserter","isGlobalInserterOpen","page","$","tab","click","toggleGlobalBlockInserter","waitForSelector","closeGlobalBlockInserter","evaluate","document","querySelector","searchForBlock","searchTerm","focus","keyboard","type","searchForPattern","$x","searchForReusableBlock","waitForXPath","insertBlock","insertButton","insertPattern","insertReusableBlock"],"mappings":"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","sourcesContent":["/**\n * Internal dependencies\n */\nimport { pressKeyWithModifier } from './press-key-with-modifier';\n\n// This selector is written to support the current and old inserter markup\n// because the performance tests need to be able to run across versions.\nconst INSERTER_SEARCH_SELECTOR =\n\t'.block-editor-inserter__search-input,input.block-editor-inserter__search';\n\n/**\n * Opens the global block inserter.\n */\nexport async function openGlobalBlockInserter() {\n\tif ( await isGlobalInserterOpen() ) {\n\t\t// If global inserter is already opened, reset to an initial state where\n\t\t// the default (first) tab is selected.\n\t\tconst tab = await page.$(\n\t\t\t'.block-editor-inserter__tabs .components-tab-panel__tabs-item:nth-of-type(1):not(.is-active)'\n\t\t);\n\n\t\tif ( tab ) {\n\t\t\tawait tab.click();\n\t\t}\n\t} else {\n\t\tawait toggleGlobalBlockInserter();\n\n\t\t// Waiting here is necessary because sometimes the inserter takes more time to\n\t\t// render than Puppeteer takes to complete the 'click' action\n\t\tawait page.waitForSelector( '.block-editor-inserter__menu' );\n\t}\n}\n\nexport async function closeGlobalBlockInserter() {\n\tif ( await isGlobalInserterOpen() ) {\n\t\tawait toggleGlobalBlockInserter();\n\t}\n}\n\nasync function isGlobalInserterOpen() {\n\treturn await page.evaluate( () => {\n\t\treturn !! document.querySelector(\n\t\t\t'.edit-post-header [aria-label=\"Add block\"].is-pressed, .edit-site-header [aria-label=\"Add block\"].is-pressed'\n\t\t);\n\t} );\n}\n\nasync function toggleGlobalBlockInserter() {\n\tawait page.click(\n\t\t'.edit-post-header [aria-label=\"Add block\"], .edit-site-header [aria-label=\"Add block\"]'\n\t);\n}\n\n/**\n * Search for block in the global inserter\n *\n * @param {string} searchTerm The text to search the inserter for.\n */\nexport async function searchForBlock( searchTerm ) {\n\tawait openGlobalBlockInserter();\n\tawait page.focus( INSERTER_SEARCH_SELECTOR );\n\tawait pressKeyWithModifier( 'primary', 'a' );\n\tawait page.keyboard.type( searchTerm );\n}\n\n/**\n * Search for pattern in the global inserter\n *\n * @param {string} searchTerm The text to search the inserter for.\n */\nexport async function searchForPattern( searchTerm ) {\n\tawait openGlobalBlockInserter();\n\t// Select the patterns tab\n\tconst [ tab ] = await page.$x(\n\t\t'//div[contains(@class, \"block-editor-inserter__tabs\")]//button[.=\"Patterns\"]'\n\t);\n\tawait tab.click();\n\tawait page.focus( INSERTER_SEARCH_SELECTOR );\n\tawait pressKeyWithModifier( 'primary', 'a' );\n\tawait page.keyboard.type( searchTerm );\n}\n\n/**\n * Search for reusable block in the global inserter.\n *\n * @param {string} searchTerm The text to search the inserter for.\n */\nexport async function searchForReusableBlock( searchTerm ) {\n\tawait openGlobalBlockInserter();\n\n\t// The reusable blocks tab won't appear until the reusable blocks have been\n\t// fetched. They aren't fetched until an inserter is used or the post\n\t// already contains reusable blocks, so wait for the tab to appear.\n\tawait page.waitForXPath(\n\t\t'//div[contains(@class, \"block-editor-inserter__tabs\")]//button[text()=\"Reusable\"]'\n\t);\n\n\t// Select the reusable blocks tab.\n\tconst [ tab ] = await page.$x(\n\t\t'//div[contains(@class, \"block-editor-inserter__tabs\")]//button[text()=\"Reusable\"]'\n\t);\n\tawait tab.click();\n\tawait page.focus( INSERTER_SEARCH_SELECTOR );\n\tawait pressKeyWithModifier( 'primary', 'a' );\n\tawait page.keyboard.type( searchTerm );\n}\n\n/**\n * Opens the inserter, searches for the given term, then selects the first\n * result that appears. It then waits briefly for the block list to update.\n *\n * @param {string} searchTerm The text to search the inserter for.\n */\nexport async function insertBlock( searchTerm ) {\n\tawait searchForBlock( searchTerm );\n\tconst insertButton = (\n\t\tawait page.$x( `//button//span[contains(text(), '${ searchTerm }')]` )\n\t )[ 0 ];\n\tawait insertButton.click();\n}\n\n/**\n * Opens the inserter, searches for the given pattern, then selects the first\n * result that appears. It then waits briefly for the block list to update.\n *\n * @param {string} searchTerm The text to search the inserter for.\n */\nexport async function insertPattern( searchTerm ) {\n\tawait searchForPattern( searchTerm );\n\tconst insertButton = (\n\t\tawait page.$x(\n\t\t\t`//div[@role = 'button']//div[contains(text(), '${ searchTerm }')]`\n\t\t)\n\t )[ 0 ];\n\tawait insertButton.click();\n}\n\n/**\n * Opens the inserter, searches for the given reusable block, then selects the\n * first result that appears. It then waits briefly for the block list to\n * update.\n *\n * @param {string} searchTerm The text to search the inserter for.\n */\nexport async function insertReusableBlock( searchTerm ) {\n\tawait searchForReusableBlock( searchTerm );\n\tconst insertButton = (\n\t\tawait page.$x( `//button//span[contains(text(), '${ searchTerm }')]` )\n\t )[ 0 ];\n\tawait insertButton.click();\n}\n"]}