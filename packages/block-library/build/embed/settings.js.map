{"version":3,"sources":["@wordpress/block-library/src/embed/settings.js"],"names":["embedAttributes","url","type","caption","source","selector","providerNameSlug","allowResponsive","default","getEmbedBlockSettings","title","description","icon","category","transforms","keywords","supports","responsive","previewable","blockDescription","edit","attributes","align","select","ownProps","core","getEmbedPreview","isPreviewEmbedFallback","isRequestingEmbedPreview","getThemeSupports","preview","undefined","previewIsFallback","fetching","themeSupports","badEmbedProvider","html","wordpressCantEmbed","data","status","validPreview","cannotEmbed","themeSupportsResponsive","dispatch","coreData","tryAgain","invalidateResolution","save","embedClassName","RichText","isEmpty","deprecated"],"mappings":"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","sourcesContent":["/**\n * Internal dependencies\n */\nimport { getEmbedEditComponent } from './edit';\n\n/**\n * External dependencies\n */\nimport classnames from 'classnames/dedupe';\n\n/**\n * WordPress dependencies\n */\nimport { __ } from '@wordpress/i18n';\nimport { compose } from '@wordpress/compose';\nimport { RichText } from '@wordpress/block-editor';\nimport { withSelect, withDispatch } from '@wordpress/data';\n\nconst embedAttributes = {\n\turl: {\n\t\ttype: 'string',\n\t},\n\tcaption: {\n\t\ttype: 'string',\n\t\tsource: 'html',\n\t\tselector: 'figcaption',\n\t},\n\ttype: {\n\t\ttype: 'string',\n\t},\n\tproviderNameSlug: {\n\t\ttype: 'string',\n\t},\n\tallowResponsive: {\n\t\ttype: 'boolean',\n\t\tdefault: true,\n\t},\n};\n\nexport function getEmbedBlockSettings( {\n\ttitle,\n\tdescription,\n\ticon,\n\tcategory = 'embed',\n\ttransforms,\n\tkeywords = [],\n\tsupports = {},\n\tresponsive = true,\n\tpreviewable = true,\n} ) {\n\tconst blockDescription =\n\t\tdescription ||\n\t\t__(\n\t\t\t'Add a block that displays content pulled from other sites, like Twitter, Instagram or YouTube.'\n\t\t);\n\tconst edit = getEmbedEditComponent( title, icon, responsive, previewable );\n\treturn {\n\t\ttitle,\n\t\tdescription: blockDescription,\n\t\ticon,\n\t\tcategory,\n\t\tkeywords,\n\t\tattributes: embedAttributes,\n\n\t\tsupports: {\n\t\t\talign: true,\n\t\t\t...supports,\n\t\t},\n\n\t\ttransforms,\n\n\t\tedit: compose(\n\t\t\twithSelect( ( select, ownProps ) => {\n\t\t\t\tconst { url } = ownProps.attributes;\n\t\t\t\tconst core = select( 'core' );\n\t\t\t\tconst {\n\t\t\t\t\tgetEmbedPreview,\n\t\t\t\t\tisPreviewEmbedFallback,\n\t\t\t\t\tisRequestingEmbedPreview,\n\t\t\t\t\tgetThemeSupports,\n\t\t\t\t} = core;\n\t\t\t\tconst preview = undefined !== url && getEmbedPreview( url );\n\t\t\t\tconst previewIsFallback =\n\t\t\t\t\tundefined !== url && isPreviewEmbedFallback( url );\n\t\t\t\tconst fetching =\n\t\t\t\t\tundefined !== url && isRequestingEmbedPreview( url );\n\t\t\t\tconst themeSupports = getThemeSupports();\n\t\t\t\t// The external oEmbed provider does not exist. We got no type info and no html.\n\t\t\t\tconst badEmbedProvider =\n\t\t\t\t\t!! preview &&\n\t\t\t\t\tundefined === preview.type &&\n\t\t\t\t\tfalse === preview.html;\n\t\t\t\t// Some WordPress URLs that can't be embedded will cause the API to return\n\t\t\t\t// a valid JSON response with no HTML and `data.status` set to 404, rather\n\t\t\t\t// than generating a fallback response as other embeds do.\n\t\t\t\tconst wordpressCantEmbed =\n\t\t\t\t\t!! preview && preview.data && preview.data.status === 404;\n\t\t\t\tconst validPreview =\n\t\t\t\t\t!! preview && ! badEmbedProvider && ! wordpressCantEmbed;\n\t\t\t\tconst cannotEmbed =\n\t\t\t\t\tundefined !== url &&\n\t\t\t\t\t( ! validPreview || previewIsFallback );\n\t\t\t\treturn {\n\t\t\t\t\tpreview: validPreview ? preview : undefined,\n\t\t\t\t\tfetching,\n\t\t\t\t\tthemeSupportsResponsive:\n\t\t\t\t\t\tthemeSupports[ 'responsive-embeds' ],\n\t\t\t\t\tcannotEmbed,\n\t\t\t\t};\n\t\t\t} ),\n\t\t\twithDispatch( ( dispatch, ownProps ) => {\n\t\t\t\tconst { url } = ownProps.attributes;\n\t\t\t\tconst coreData = dispatch( 'core/data' );\n\t\t\t\tconst tryAgain = () => {\n\t\t\t\t\tcoreData.invalidateResolution( 'core', 'getEmbedPreview', [\n\t\t\t\t\t\turl,\n\t\t\t\t\t] );\n\t\t\t\t};\n\t\t\t\treturn {\n\t\t\t\t\ttryAgain,\n\t\t\t\t};\n\t\t\t} )\n\t\t)( edit ),\n\n\t\tsave( { attributes } ) {\n\t\t\tconst { url, caption, type, providerNameSlug } = attributes;\n\n\t\t\tif ( ! url ) {\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tconst embedClassName = classnames( 'wp-block-embed', {\n\t\t\t\t[ `is-type-${ type }` ]: type,\n\t\t\t\t[ `is-provider-${ providerNameSlug }` ]: providerNameSlug,\n\t\t\t} );\n\n\t\t\treturn (\n\t\t\t\t<figure className={ embedClassName }>\n\t\t\t\t\t<div className=\"wp-block-embed__wrapper\">\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t`\\n${ url }\\n` /* URL needs to be on its own line. */\n\t\t\t\t\t\t}\n\t\t\t\t\t</div>\n\t\t\t\t\t{ ! RichText.isEmpty( caption ) && (\n\t\t\t\t\t\t<RichText.Content\n\t\t\t\t\t\t\ttagName=\"figcaption\"\n\t\t\t\t\t\t\tvalue={ caption }\n\t\t\t\t\t\t/>\n\t\t\t\t\t) }\n\t\t\t\t</figure>\n\t\t\t);\n\t\t},\n\n\t\tdeprecated: [\n\t\t\t{\n\t\t\t\tattributes: embedAttributes,\n\t\t\t\tsave( { attributes } ) {\n\t\t\t\t\tconst { url, caption, type, providerNameSlug } = attributes;\n\n\t\t\t\t\tif ( ! url ) {\n\t\t\t\t\t\treturn null;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst embedClassName = classnames( 'wp-block-embed', {\n\t\t\t\t\t\t[ `is-type-${ type }` ]: type,\n\t\t\t\t\t\t[ `is-provider-${ providerNameSlug }` ]: providerNameSlug,\n\t\t\t\t\t} );\n\n\t\t\t\t\treturn (\n\t\t\t\t\t\t<figure className={ embedClassName }>\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t`\\n${ url }\\n` /* URL needs to be on its own line. */\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t{ ! RichText.isEmpty( caption ) && (\n\t\t\t\t\t\t\t\t<RichText.Content\n\t\t\t\t\t\t\t\t\ttagName=\"figcaption\"\n\t\t\t\t\t\t\t\t\tvalue={ caption }\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t</figure>\n\t\t\t\t\t);\n\t\t\t\t},\n\t\t\t},\n\t\t],\n\t};\n}\n"]}