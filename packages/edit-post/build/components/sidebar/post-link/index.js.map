{"version":3,"sources":["@wordpress/edit-post/src/components/sidebar/post-link/index.js"],"names":["PANEL_NAME","PostLink","isOpened","onTogglePanel","isEditable","postLink","permalinkPrefix","permalinkSuffix","editPermalink","forceEmptyField","setState","postSlug","postTypeLabel","prefixElement","postNameElement","suffixElement","newValue","event","target","value","select","isPermalinkEditable","getCurrentPost","isCurrentPostPublished","getPermalinkParts","getEditedPostAttribute","getEditedPostSlug","isEditorPanelEnabled","isEditorPanelOpened","getPostType","link","postTypeName","postType","permalinkParts","isPublished","isEnabled","isViewable","hasPermalinkParts","prefix","suffix","dispatch","toggleEditorPanelOpened","editPost","newSlug","slug"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport { get } from 'lodash';\n\n/**\n * WordPress dependencies\n */\nimport { __ } from '@wordpress/i18n';\nimport { PanelBody, TextControl, ExternalLink } from '@wordpress/components';\nimport { withSelect, withDispatch } from '@wordpress/data';\nimport { compose, ifCondition, withState } from '@wordpress/compose';\nimport { cleanForSlug } from '@wordpress/editor';\nimport { safeDecodeURIComponent } from '@wordpress/url';\n\n/**\n * Module Constants\n */\nconst PANEL_NAME = 'post-link';\n\nfunction PostLink( {\n\tisOpened,\n\tonTogglePanel,\n\tisEditable,\n\tpostLink,\n\tpermalinkPrefix,\n\tpermalinkSuffix,\n\teditPermalink,\n\tforceEmptyField,\n\tsetState,\n\tpostSlug,\n\tpostTypeLabel,\n} ) {\n\tlet prefixElement, postNameElement, suffixElement;\n\tif ( isEditable ) {\n\t\tprefixElement = permalinkPrefix && (\n\t\t\t<span className=\"edit-post-post-link__link-prefix\">\n\t\t\t\t{ permalinkPrefix }\n\t\t\t</span>\n\t\t);\n\t\tpostNameElement = postSlug && (\n\t\t\t<span className=\"edit-post-post-link__link-post-name\">\n\t\t\t\t{ postSlug }\n\t\t\t</span>\n\t\t);\n\t\tsuffixElement = permalinkSuffix && (\n\t\t\t<span className=\"edit-post-post-link__link-suffix\">\n\t\t\t\t{ permalinkSuffix }\n\t\t\t</span>\n\t\t);\n\t}\n\n\treturn (\n\t\t<PanelBody\n\t\t\ttitle={ __( 'Permalink' ) }\n\t\t\topened={ isOpened }\n\t\t\tonToggle={ onTogglePanel }\n\t\t>\n\t\t\t{ isEditable && (\n\t\t\t\t<div className=\"editor-post-link\">\n\t\t\t\t\t<TextControl\n\t\t\t\t\t\tlabel={ __( 'URL Slug' ) }\n\t\t\t\t\t\tvalue={ forceEmptyField ? '' : postSlug }\n\t\t\t\t\t\tonChange={ ( newValue ) => {\n\t\t\t\t\t\t\teditPermalink( newValue );\n\t\t\t\t\t\t\t// When we delete the field the permalink gets\n\t\t\t\t\t\t\t// reverted to the original value.\n\t\t\t\t\t\t\t// The forceEmptyField logic allows the user to have\n\t\t\t\t\t\t\t// the field temporarily empty while typing.\n\t\t\t\t\t\t\tif ( ! newValue ) {\n\t\t\t\t\t\t\t\tif ( ! forceEmptyField ) {\n\t\t\t\t\t\t\t\t\tsetState( {\n\t\t\t\t\t\t\t\t\t\tforceEmptyField: true,\n\t\t\t\t\t\t\t\t\t} );\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif ( forceEmptyField ) {\n\t\t\t\t\t\t\t\tsetState( {\n\t\t\t\t\t\t\t\t\tforceEmptyField: false,\n\t\t\t\t\t\t\t\t} );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} }\n\t\t\t\t\t\tonBlur={ ( event ) => {\n\t\t\t\t\t\t\teditPermalink( cleanForSlug( event.target.value ) );\n\t\t\t\t\t\t\tif ( forceEmptyField ) {\n\t\t\t\t\t\t\t\tsetState( {\n\t\t\t\t\t\t\t\t\tforceEmptyField: false,\n\t\t\t\t\t\t\t\t} );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} }\n\t\t\t\t\t/>\n\t\t\t\t\t<p>\n\t\t\t\t\t\t{ __( 'The last part of the URL.' ) }{ ' ' }\n\t\t\t\t\t\t<ExternalLink href=\"https://wordpress.org/support/article/writing-posts/#post-field-descriptions\">\n\t\t\t\t\t\t\t{ __( 'Read about permalinks' ) }\n\t\t\t\t\t\t</ExternalLink>\n\t\t\t\t\t</p>\n\t\t\t\t</div>\n\t\t\t) }\n\t\t\t<h3 className=\"edit-post-post-link__preview-label\">\n\t\t\t\t{ postTypeLabel || __( 'View post' ) }\n\t\t\t</h3>\n\t\t\t<div className=\"edit-post-post-link__preview-link-container\">\n\t\t\t\t<ExternalLink\n\t\t\t\t\tclassName=\"edit-post-post-link__link\"\n\t\t\t\t\thref={ postLink }\n\t\t\t\t\ttarget=\"_blank\"\n\t\t\t\t>\n\t\t\t\t\t{ isEditable ? (\n\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t{ prefixElement }\n\t\t\t\t\t\t\t{ postNameElement }\n\t\t\t\t\t\t\t{ suffixElement }\n\t\t\t\t\t\t</>\n\t\t\t\t\t) : (\n\t\t\t\t\t\tpostLink\n\t\t\t\t\t) }\n\t\t\t\t</ExternalLink>\n\t\t\t</div>\n\t\t</PanelBody>\n\t);\n}\n\nexport default compose( [\n\twithSelect( ( select ) => {\n\t\tconst {\n\t\t\tisPermalinkEditable,\n\t\t\tgetCurrentPost,\n\t\t\tisCurrentPostPublished,\n\t\t\tgetPermalinkParts,\n\t\t\tgetEditedPostAttribute,\n\t\t\tgetEditedPostSlug,\n\t\t} = select( 'core/editor' );\n\t\tconst { isEditorPanelEnabled, isEditorPanelOpened } = select(\n\t\t\t'core/edit-post'\n\t\t);\n\t\tconst { getPostType } = select( 'core' );\n\n\t\tconst { link } = getCurrentPost();\n\n\t\tconst postTypeName = getEditedPostAttribute( 'type' );\n\t\tconst postType = getPostType( postTypeName );\n\t\tconst permalinkParts = getPermalinkParts();\n\n\t\treturn {\n\t\t\tpostLink: link,\n\t\t\tisEditable: isPermalinkEditable(),\n\t\t\tisPublished: isCurrentPostPublished(),\n\t\t\tisOpened: isEditorPanelOpened( PANEL_NAME ),\n\t\t\tisEnabled: isEditorPanelEnabled( PANEL_NAME ),\n\t\t\tisViewable: get( postType, [ 'viewable' ], false ),\n\t\t\tpostSlug: safeDecodeURIComponent( getEditedPostSlug() ),\n\t\t\tpostTypeLabel: get( postType, [ 'labels', 'view_item' ] ),\n\t\t\thasPermalinkParts: !! permalinkParts,\n\t\t\tpermalinkPrefix: permalinkParts?.prefix,\n\t\t\tpermalinkSuffix: permalinkParts?.suffix,\n\t\t};\n\t} ),\n\tifCondition( ( { isEnabled, postLink, isViewable, hasPermalinkParts } ) => {\n\t\treturn isEnabled && postLink && isViewable && hasPermalinkParts;\n\t} ),\n\twithDispatch( ( dispatch ) => {\n\t\tconst { toggleEditorPanelOpened } = dispatch( 'core/edit-post' );\n\t\tconst { editPost } = dispatch( 'core/editor' );\n\t\treturn {\n\t\t\tonTogglePanel: () => toggleEditorPanelOpened( PANEL_NAME ),\n\t\t\teditPermalink: ( newSlug ) => {\n\t\t\t\teditPost( { slug: newSlug } );\n\t\t\t},\n\t\t};\n\t} ),\n\twithState( {\n\t\tforceEmptyField: false,\n\t} ),\n] )( PostLink );\n"]}